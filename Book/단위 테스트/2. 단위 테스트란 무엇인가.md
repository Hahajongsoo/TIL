단위 테스트에 접근하는 방법은 두 가지 뚜렷한 견해로 나뉘었다. 각각 고전파(classic school)와 런던파(london school)로 알려져 있다. 고전파는 모든 사람이 단위 테스트와 테스트 주도 개발에 원론적으로 접근하는 방식이기 때문에 고전이라고 한다. 런던파는 런던의 프로그래밍 커뮤니티에서 시작 됐다. 고전적 스타일과 런던 스타일의 차이는 5장의 토대가 되고, 5장에서는 목과 테스트 취약성을 다룬다.
# 단위 테스트의 정의
중요하지 않은 것들을 제외하면 다음과 같이 가장 중요한 세 가지 속성이 있다.
단위 테스트는 
- 작은 코드 조각(단위)을 검증하고,
- 빠르게 수행하고,
- 격리된 방식으로 처리하는 자동화된 테스트다.
대중의 의견이 크게 다른 것은 세 번째 속성이다. 격리 문제는 단위 테스트의 고전파와 런던파를 구분하는 근원적 차이이다. 두 분파 간의 모든 차이는 격리가 정확히 무엇인지에 대한 의견 차이 하나로 자연스럽게 시작됐다.
## 격리 문제에 대한 런던파의 접근
런던파에서는 테스트 대상 시스템을 협력자(collaborator)에게서 격리하는 것을 일컫는다. 하나의 클래스가 다른 클래스 또는 여러 클래스에 의존하면 이 모든 의존성을 태스트 대역(test double)으로 대체해야 한다. 이런 식으로 동작을 외부 영향과 분리해서 테스트 대상 클래스에만 집중할 수 있다.

![](images/figure2.png)

위의 그림은 일반적으로 격리가 어떻게 이뤄지는지 보여준다. 의존성이 포함된 테스트 대상 시스템을 검증하는 단위 테스트는 이제 해당 의존성과 별개로 수행할 수 있다.
이 방법의 한 가지 이점은 코드 베이스의 어느 부분이 고장 났는지 확실히 알 수 있다는 점이다. 테스트의 모든 의존성은 테스트 대역으로 대체됐기 때문에 대상 시스템이 고장 난 것이다.
또 다른 이점은 객체 그래프(같은 문제를 해결하는 클래스의 통신망)를 분할할 수 있다는 것이다. 모든 클래스가 각각 의존성을 갖고 있으며 또 그 의존성이 다른 의존성을 갖고 있는 식으로 그래프가 복잡해 질 수 있다.
의존성을 가진 코드베이스를 테스트하는 것은 테스트 대역 없이는 어렵다. 유일하게 남은 선택은 전체 객체 그래프를 다시 만드는 것이다.(테스트를 하려면 실제 제품에 해당하는 의존성 외에 테스트 목적의 의존성들로 구성해서 대체해야 하는데, 직접 참조하는 의존성을 테스트 목적의 의존성으로 대체하고 해당 의존성들을 다시 테스트 목적의 의존성을 참조하는 식으로 모두 대체하게 되면 결국 이 작업은 객체 그래프를 다시 만든다고 할 수 있다.)
테스트 대역을 사용하면 클래스의 직접적인 의존성을 대체할 수 있고 더 나아가 의존성의 의존성을 다룰 필요도 없다. 그래프를 효과적으로 분해해 단위 테스트에서 준비를 크게 줄일 수 있다.
단위 테스트 격리의 또 다른 이점이 있다. 프로젝트 전반적으로 한 번에 한 클래스만 테스트하라는 지침을 도입하면 전체 단위 테스트 스위트를 간단한 구조로 할 수 있다. 클래스가 있다면 클래스에 해당하는 단위 테스트 클래스를 생성하면 된다.

다음 예시에서는 고전적인 스타일로 작성된 샘플 테스트를 살펴본 후 런던 방식을 사용해 다시 작성해본다.
온라인 상점을 운영한다고 가정하자. 샘플 애플리케이션에는 고객이 제품을 구매할 수 있다는 간단한 유스케이스가 하나 있다. 상점에 재고가 충분하면 구매는 성공, 구매 수량만큼 상점의 제품 수량이 줄어든다. 제품이 충분하지 않으면 구매는 성공하지 못하며 상점에 아무 일도 일어나지 않는다.
예제 2.1에는 상점에 재고가 충분히 있을 때만 구매가 성공하는지 검증하는 두 가지 테스트가 있다. 고전적 스타일로 작성됐으며 일반적인 3단 구성인 준비, 실행, 검증 패턴을 사용한다.(AAA, Arrange, Act, Assert)
```

```