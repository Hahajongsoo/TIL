#CS #Network #inflearn
# 인터넷 통신
PC간 통신은 다른 네트워크에 있는 경우 인터넷 망에 있는 여러 노드를 거쳐서 이루어지게 된다. 

# IP(Internet Protocol)
통신을 하기위해선 먼저 IP 주소가 있어야 한다. 
IP의 역할은 지정한 IP 주소에 데이터를 전달하는 것이고 패킷 단위로 데이터를 전달하게 된다. 
패킷은 하나의 규칙이고 출발지 IP주소, 목적지 IP주소 등의 정보와 데이터를 감싼 형태이다. 클라이언트가 보낸 패킷은 중간 노드들이 프로토콜을 이용해 다음 노드들로 넘기게되고 결국 패킷이 서버에 도달하게 된다.
서버는 그에대한 응답을 클라이언트에게 보내게 된다. 

## IP 프로토콜의 한계
- 비연결성
	- 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷을 전송한다.
- 비신뢰성
	- 중간에 패킷이 사라지는 경우
	- 패킷이 순서대로 오지 않는 경우
- 프로그램 구분
	- 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상인 경우

### 대상이 서비스 불능, 패킷 전송
클라이언트는 대상 서버가 패킷을 받을 수 있는 상태인지 모르는 상태에서 패킷을 보내게 된다. 

### 패킷 소실
노드들을 거치면서 어떤 경우가 생길지는 알 수 없다. 중간 노드가 꺼져있거나 연결이 제대로 되어있지 않는 경우 패킷이 소실되더라도 알 수 없다.

### 패킷 전달 순서 문제
보통 한 패킷 데이터의 크기는 1500byte다. 패킷들이 여러 노드를 거치면서 동일한 경로로 가지 않을 수 있고 그 결과 순서대로 도착하지 않을 수 있다. 

# TCP, UDP
앞의 비연결성, 비신뢰성을 해결할 수 있는 것이 TCP이다. 
인터넷 프로토콜 스택은 애플리케이션, 전송, 인터넷, 네트워크 인터페이스의 4계층으로 이루어져 있다. 

![](images/Pasted%20image%2020230210202337.png)
1. 프로그램이 Hello, world! 메시지 생성
2. SOCKET 라이브러리를 통해 OS에 전달
3. TCP 정보를 생성, 메시지 데이터를 감싼다.
4. IP 패킷 생성, TCP 데이터를 감싼다. 
5. 이후 랜카드를 통해 이더넷 프레임이 씌워진 상태로 인터넷으로 나가게된다.

- IP 패킷의 경우 출발지 IP, 목적지 IP 등의 정보를 가지고 있다.
- TCP/IP 세그먼트의 경우 출발지 포트, 목적지 포트, 전송 제어, 순서, 검증 정보 등을 갖고 있다.

## TCP 특징
전송 제어 프로토콜(Transmission Control Protocol)
- 연결 지향 - TCP 3 way handshake
	- 먼저 연결을 하고나서 데이터를 보내게 된다.
- 데이터 전달 보증
- 순서 보장

- 신뢰할 수 있는 프로토콜

### TCP 3 way handshake
![](images/Pasted%20image%2020230210202919.png)
- 연결 이후에 데이터를 보내게 된다. 즉 데이터를 보낼 수 없는 경우 데이터를 보내지 않게 된다.
- 이는 물리적으로 연결이 된 것이 아니고 개념적으로 연결된 것 이다. 

### 데이터 전달 보증

![](images/Pasted%20image%2020230210203149.png)

### 순서 보장

![](images/Pasted%20image%2020230210203204.png)
- 기본적으로는 받았던 패킷을 버리고 2번 패킷부터 다시 받는 형식을 취한다.

## UDP
사용자 데이터그램 프로토콜
- 하얀 도화지에 비유(기능이 거의 없음)
- 연결 지향 x
- 데이터 전달 보증 x
- 순서 보장 x
- 데이터 전달 및 순서가 보장되지 않지만, 단순하고 빠르다
- IP와 거의 같지만 포트와 체크섬 정도만 추가됨

# PORT
하나의 서버에 둘 이상의 연결을 해야한다면 이 경우 IP만으로는 해결할 수 없는 문제가 발생한다.
이때 세그먼트에 담겨있는 포트번호를  통해 어떤 프로세스로 가야하는 패킷인지를 구분하게 된다. 

![](images/Pasted%20image%2020230210210153.png)

클라이언트에서 나가는 몇 번 포트가 서버의 몇 번 포트로 들어가는지를 패킷에 전부 명시하는 것이다. 

- 0 ~ 65535 할당 가능
- 0 ~ 1024: well known port

# DNS
IP 주소는 기억하기 어려울뿐만 아니라 IP가 변경될 수도 있다. 따라서 이 IP를 특정 이름과 연결 하는 것이 DNS이다.
Domain Name System은 도메인명과 IP를 연결한다. 그리고 이 정보를 DNS 서버가 갖고 있다. 클라이언트가 특정 도메인으로 요청을 보낼 때 해당 IP에 대한 정보를 DNS 서버를 통해서 알게 되고 이후에 해당 IP로 연결을 보내게 되는 것이다. 