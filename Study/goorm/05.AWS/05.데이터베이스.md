# 데이터베이스
## 데이터베이스란
- 여러 사람에 의해 공유되어 사용될 목적으로 통함되어 관리되는 데이터 집합
- 특정 다수의 사용자들에게 필요한 정보를 제공하거나, 조직 내에서 필요한 정보를 체계적으로 저장 및 보관


## 데이터베이스 트랜잭션 특성
트랜젝션은 여러 작업들을 하나로 묶은 단위이다. 한 덩어리의 작업들은 모두 실행되거나, 실행되지 않는다.
돈을 출금하고 송금하는 상황에서 돈을 출금하고 송금하려는데 시스템이 멈추게 된다면 돈은 출금 됐지만 송금되지 않고 사라지는 상황이 발생하게 된다. 트랜젝션이 있으면 이러한 상황을 막아준다.


### **Atomicity(원자성)**
모든 작업이 반영되거나 모두 롤백되는 특성

### Consistency(일관성)
데이터는 미리 정의된 규칙에서만 수정이 가능한 특성. 숫자컬럼에 문자열값을 저장이 안되도록 보장

### Isolation(고립성)
A와 B 두개의 트랜젝션이 실행되고 있을 때, A의 작업들이 B에게 보여지는 정도

### Durability(영구성)
한번 반영(커밋)된 트랜젝션의 내용은 영원히 적용되는 특성


# Amazon RDS
# RDS(Relational Database Service)
- 클라우드에서 관계형 데이터베이스를 더욱 간편하게 설정, 운영 및 확장할 수 있는 서비스
- 하드웨어 프로지버닝, 데이터베이스 설정, 패치 및 백업과 같은 관리 작업 자동화
- 데이터베이스 인스턴스 유형(메모리, 성능 또는 I/O 최적화)으로 제공
- AWS Database Migration Services를 사용해 기존 데이터베이스를 RDS로 손쉽게 마이그레이션 가능

| 구분      | 내용                                                                                                                                                                                                                                                                                                                                                                     |
| --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 서비스명  | Amazon RDS                                                                                                                                                                                                                                                                                                                                                               |
| 설명      | 주로 사용되는 6개의 데이터베이스 엔진 중에서 선택할 수 있는 아마존 관계형 데이터베이스 서비스                                                                                                                                                                                                                                                                            |
| 주요 특징 | - 관리 용이성: 인프라의 프로비저닝/DB 설치 및 유지 관리 불필요<br>- 뛰어난 확장성: 서비스 중단 없이 서버 및 스토리지 확장 가능<br>- 가용성 및 내구성: 안정성이 뛰어난 인프라 제공(멀티AZ)<br>- 빠른 속도: SSD 지원 스토리지 옵션 및 고성능 OLTP에 최적화된 옵션과 비용 효율적 범용사례에서 옵션 선택 가능<br>- 보안: 데이터베이스와 네트워크에 대한 액세스를 손쉽게 제어 |
| 프리티어  | - MySQL, PostgreSQL, MariaDB, Oracle BYOL, SQL Server 지원<br>- RDS 단일 AZ db.t2.micro 인스턴스를 750시간 무료 이용<br>- 가입 후 12개월 이후에 종료                                                                                                                                                                                                                                                                                                                                                                         |


## AWS에서  클라우드 데이터베이스 서비스 선택
- Amazon EC2 인스턴스에 직접 DB 설치
	- 기존 온프레미스에서 사용하던 데이터베이스 그대로 사용
	- 라이센스에 주의(별도로 클라우드용 라이센스를 운영하는 경우가 있다.)
- AWS에서 제공되는 관리형 데이터베이스 사용
	- 데이터베이스의 설치 및 운영/관리를 할  필요가 없다.
	- 서비스의 용도 및 사용량에 따라 원하는 형태의 리소스를 선택 가능
	- 다음의 서비스들이 있다.
		- RDS: 관계형 데이터베이스 서비스
		- DynamoDB: NoSQL 기반의 중단 없는 확장성 제공
		- RedShift: 대용량 병렬 페타바이트급 데이터웨어하우스 서비스제공
## Amazon RDS의 주요 특징
### 유연한 인스턴스 및 스토리지 확장
- 다양한 CPU/메모리 옵션 제공
- Cloudwatch와의 연계를 통해 트래픽에 따른 증설, 사양 축소 가능
- 일반적인 워크로드는 SSD 사용
- 접속이 빈번하지 않은 작은 워크로드의 경우 Magnetic을 사용하여 저렴한 비용으로 서비스 가능
### 손쉽게 사용 가능한 백업 및 복원
- 자동 백업 설정 가능
- 데이터베이스는 최대 35일 까지 데이터 보존, 백업된 스냅샷으로 Database 생성 가능
### 멀티 AZ를 통한 고가용성 확보
- 멀티 AZ 기능을 활용하여 리전 내 AZ 간 데이터베이스 동기화 구성 가능
- 장애 상황 발생 시 자동으로 데이터베이스 failover 수행가능
- 리플리케이션을 통한 가용성 지원 가능
- 읽기 트래픽을 자동 관리하는 Read Replica로 분산 서비스를 제공 가능, 이를 통해 읽기 ㅓㅅ비스에 대한 부하를 분산처리 가능
### RDS 암호화 옵션을 통한 보안성 강화
- 옵션을 통한 데이터에 대한 암호화 기능 제공
- 데이터 백업, 스냅샷, Read Replica에도 적용된다.
- KMS를 통해 사용자가 생성하고 관리하는 키 사용이 가능
- 암호화 Enable 이후 암호화 Disable은 불가능하며 암호화 DB에서만 암호화 Read Replica 생성 가능
- 암호화되지 않은 백업을 암호화된 DB로의 데이터 복구는 불가능
### Database Migration 서비스
- AWS Database Migration Services를 통해 동종 혹은 다른 DB 엔진으로부터 RDS로 데이터에 대한 Migration을 지원 
- EC2 또는 RDS 간의 데이터 리플리케이션을 통해 원하는 시점에 비용 효율적인 데이터베이스에 대한 데이터 이전을 지원

# 실습
## MySQL용 DB 인스턴스 생성
1. VPC 생성
	1. 서브넷 생성
	2. 인터넷 게이트웨이 생성 및 연결
	3. 라우팅 테이블 생성 및 수정
	4. NAT 게이트웨이 생성 및 라우팅 테이블 수정
2. MySQL 클라이언트, 서버 인스턴스 생성

## RDS 이용
1. RDS 선택
2. 데이터베이스 > 데이터베이스 생성
3. 표준 생성
	- mariadb
	- 프리티어
	- 컴퓨팅리소스 연결 안함

## RDS 삭제 시 스냅샷 생성 가능