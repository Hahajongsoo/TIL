OSI 7 Layer에서 전송, 세션, 표현, 응용 계층에 대해서 배웠다. 역시 다시 중요한 것은 PUD, 프로토콜, 장비이다. 특히 port의 필요성에 대해서 강조하셨다. 그리고 netstat을 이용해 세션 정보를 확인 하고 PID를 확인할 수 있었다. IP에서는 IP주소를 나누는 것에 대해서 서브넷 마스크와 서브넷팅을 강조하셨다. 


# OSI 7 Layer(3, 4, 5, 6)
## 전송 계층 
- 전송 계층은 End-to-End 연결을 한다. Application 사이에 논리적인 통로를 제공한다. 전송 문제를 관리하고 신뢰성 있는 전송을 보장한다.
- PDU는 Segment이다.
- 프로토콜에는 TCP, UDT 가 있다.

## 세션 계층
- 세션 계층은 호스트간의 연결을 한다. 응용프로그램 사이에서 통신을 Start, Maintain, Stop을 관리한다.
- 서버를 생각해보면 하나의 포트에 여러개의 입력이 들어오게 된다. 이때 이를 구분하는 것이 세션이고 클라이언트 주소가 명시되면 하나의 세션이 된다. 
- 네트워크는 서로 연결이 되면 서로 주고 받는 것이 가능해지기 때문에 사용자가 접근할 수 있도록 포트를 열어놓고 (리스닝) 포트와 응용프로그램을 바인딩한다.
- 세션 계층 부터 PDU는 Data이다.

## 표현 계층
- App Layer에 대한 Data 전송 Syntax 협의, Data Format 결정 및 구성, Code 변환, 압축, 인코딩, 암호화, 코덱
- 사용 프로토콜에는 SSL/TLS 가 있다.

## 응용 계층
- 사용자에게 다양한 Network Service를 제공한다.(SMTP, FTP, 가상 터미널 등)
- 프로토콜에는 HTTP등이 있다.

# Port의 필요성, Port range 별 특징
- 전송 계층은 데이터를 전송하기 위한 계층으로 여기서 제일 중요한 것은 포트 번호이다. 포트는 서비스 즉 프로세스를 나타낸다. 만일 포트번호가 없다면 어느 프로세스로 향해야하는지 매번 체크해야 한다. LAN 선만 꽂아놔도 CPU가 계속 연산처리를 하는 현상이 발생하게 될 수 있는 것이다. 
https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml
>Port numbers are assigned in various ways, based on three ranges: System Ports (0-1023), User Ports (1024-49151), and the Dynamic and/or Private Ports (49152-65535)

- 시스템 포트(0~1023): administrator, root 권한으로 프로그램을 실행
	- 웹, DNS 등이 있다.
- 유저 포트(1024 ~ 49151): user 권한으로 프로그램을 실행
- 다이나믹/프라이빗 포트(49152~65535): client port(source port)로 셋팅되는 포트로 OS가 할당한다.
- OS에 지정되어 있는 포트들이 있기는 하다. FTP(21), TFP-Data(20, active-mode), SSH, SCP, SFTP(22), telnet(23), SMTP(25), DNS(53), TFTP(69, udp), HTTP(80), HTTPS(443), POP3(110), IMAP(143), sql-server(1433), mysql(3306), mariadb(3306), oracle(1521)

# Session 정보 확인
세션 정보는 netstat 명령어를 통해 확인할 수 있다. 플래그를 사용해서 포트 번호와 PID를 확인 해볼 수 있다. 
- mac os의 경우 `netstat -anv -p TCP` 를 사용하면 다음과 같은 결과를 얻을 수 있다.
![](images/Pasted%20image%2020221220184211.png)
- naver.com에 접속했다가 끄는 것으로 세션이 만들어지고 사라지는 것을 확인해 볼 수 있다. 
	- `nslookup` 으로 확인한 naver.com의 주소를 확인하면 223.130으로 시작을 하고 네이버에 접속을 하면 세션이 생기고 해당 브라우저를 끄면 세션이 종료되는 것을 확인할 수 있다. 그리고 그때의 PID 인 17634는 크롬 웹 브라우저이다.
![](images/Pasted%20image%2020221220184611.png)
![](images/Pasted%20image%2020221220184712.png)

# IP
- 네트워크에 접속되어 있는 각 컴퓨터에 고유한 식별 번호가 부여되어야 데이터 송수신이 가능하다. 인터넷에 연결되어 있는 모든 컴퓨터에게 고유의 주소를 부여하게 되는데 이를 IP 주소라고 한다. 
- 8비트 크기의 필드 네 개를 이용한 32비트 논리 주소이다. 
- IP주소의 효율적인 배정을 위해서 클래스라는 개념을 도입했으나 지금은 사용하지 않는다.
	- 0으로 시작 A클래스(0.0.0.0 ~ 127.255.255.255), 10 으로 시작 B 클래스(128.0.0.0 ~ 191.255.255.255), 110으로 시작 C클래스(192.0.0.0 ~ 223.255.255.255), 1110으로 시작 D클래스, 1111으로 시작 E클래스
- IP 주소는 네트워크 주소와 호스트 주소로 구분한다.
	- 네트워크 주소
		- 전체 네트워크를 보다 작은 네트워크로 분할하여 각 호스트가 속한 네트워크를 대표하는데 사용
		- 브로드 캐스트를 들을 수 있는 주소이다.
	- 호스트 주소
		- 네트워크 주소로 표현되는 네트워크 내부에서 각 호스트의 주소를 표현한다.
		- 전체 32비트에서 네트워크 주소를 제외한 나머지에 해당한다.
- 클래스 방식을 추구하고 있지는 않지만 D클래스와 E클래스는 남아있기에 해당 주소에는 IP를 할당할 수 없다.

## 서브넷 마스크
- 네트워크 주소와 호스트 주소를 구분하는 정보
```
IPv4 주소 ........ : 192.168.0.4
서브넷 마스크 ......... : 255.255.255.0
```
위의 경우 알 수 있는 정보는 많다.
1. 네트워크 ID, 호스트 ID
	- 네트워크 ID: 네트워크 ID는 `192.168.0` 
	- 호스트 ID는 `4` 
2. 네트워크 주소와 브로드캐스트 주소
	- 네트워크 주소: `192.168.0.0`
	- 브로드캐스트 주소: `192.168.0.255`
3. 서브넷팅 유무
	- 서브넷팅 되어있지 않다.
네트워크 주소와 브로드 캐스트 주소는 정해지는 규칙이 존재한다. 해당 네트워크에서 가장 첫 주소는 네트워크 주소가 되고 가장 마지막 주소는 브로드 캐스트 주소가 된다. 따라서 해당 네트워크에서 호스트 주소로 사용할 수 있는 주소의 수는 해당 네트워크에 할당된 주소에서 2를 뺀 값이 된다.

### prefix
서브넷 마스크를 나타내는 방법 중 하나로 서브넷 마스크에서 1의 개수를 의미한다. 예를 들어 `255.255.255.0`는 /24 이다. 

### 서브넷팅
- 네트워크를 분리하는 것을 서브넷팅이라고 한다. 호스트 ID를 네트워크 ID로 가져올 때 마다 호스트 수는 2로 나누어지고 네트워크 수는 2배가 된다.
- 네트워크 크기를 조절하는 이유는 브로드 캐스트 사이즈를 관리하는 것과 네트워크 관리를 위함이다.

- 서브넷 마스크가 255.255.255.0 인 경우는 네트워크를 나누지 않는다.
- 서브넷 마스크가 255.255.255.128 인 경우는 네트워크를 둘로 나눔을 의미한다.
	- 1111111.1111111.1111111.10000000 
	- /25

192.168.0.4 / 255.255.255.128 의 네트워크 주소와 브로드 캐스트 주소는?
- 네트워크 주소 : 192.168.0.0
- 브로드캐스트 주소: 192.168.0.127

192.168.0.200 / 255.255.255.128 의 네트워크 주소와 브로드 캐스트 주소는?
- 네트워크 주소: 192.168.0.128
- 브로드캐스트 주소: 192.168.0.255

200.200.200.150 / 255.255.255.224 의 네트워크 주소와 브로드 캐스트 주소는?
- 네트워크 주소: 200.200.200.128
- 브로드캐스트 주소: 200.200.200.159

192.168.0.120/26 의 네트워크 주소와 브로드 캐스트 주소는?
- 네트워크 주소: 192.168.0.64
- 브로드캐스트 주소: 192.168.0.127





