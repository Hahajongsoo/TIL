쿠버네티스에서 컨테이너를 실행하는 것은 워크로드라고 하고 워크로드에는 파드와 워크로드 리소스가 있다. (워크로드 리소스의 원래 이름은 컨트롤러였다. 그래서 책에 워크로드 리소스라고 나와있는 것) 
대강 간단하게 파드를 컨테이너라고 볼 수 있다. 그리고 워크로드 리소스(컨트롤러)는 파드를 컨트롤하는 것이다. 워크로드 리소스는 파드를 만드는 것에 목적이 있다. 앞으로 파드를 직접 만들일은 없고 워크로드 리소스를 통해서 파드를 만들게 될 것이다. 파드가 기본이 되기 때문에 파드에 대한 이해가 필요하다.

- ==파드는 쿠버네티스에서 생성하고 관리할 수 있는 배포 가능한 가장 작은 컴퓨팅 단위==이다. (배포 가능하다는 것에 워크로드, application)
	- 쿠버네티스는 파드를 관리하는 것이지 컨테이너를 관리하는 것이 아니다. 
- 파드는 하나 이상의 컨테이너 그룹이다. ==이 그룹은 스토리지 및 네트워크를 공유==하고, 해당 컨테이너를 구동하는 방식에 대한 명세를 갖는다. 
	- 보통은 파드 하나에 컨테이너 하나를 갖는 형태(singleton)를 가지지만 둘 이상의 컨테이너를 가지는 경우도 있다. 
	- [여러 컨테이너를 두는 유형](https://kubernetes.io/blog/2015/06/the-distributed-system-toolkit-patterns/)
		- sidecar containers: 주 역할을 하는 컨테이너와 이를 ==**보조**하는== 컨테이너로 이루어진 파드이다. 예를 들어 웹서버 컨테이너와 로그를 저장하는 컨테이너로 파드를 생성할 수 있다.
		- ambassador containers: 주 역할을 하는 컨테이너의 proxy 역할을 하는 컨테이너를 만드는 것이다. 말 그대로 ambassador 의 역할을 하는 컨테이너를 두는 것
		- adapter containers: 위와 반대로 네트워크가 안으로 들어올 때 어댑터를 거쳐서 주 역할을 하는 컨테이너로 들어오게 한다. 주로 모니터링을 하는 컨테이너를 둔다.
- 파드의 콘텐츠는 항상 함께 배치되고, 함께 스케줄되며, 공유 콘텍스트에서 실행된다. 파드는 애플리케이션 별 "논리 호스트"를 모델링한다. 클라우드가 아닌 콘텍스트에서, 동일한 물리 또는 가상 머신에서 실행되는 애플리케이션은 동일한 논리 호스트에서 실행되는 클라우드 애플리케이션과 비슷하다. 
- 파드의 공유 콘텍스트는 리눅스 네임스페이스, cgroup 및 도커 컨테이너를 격리하는 것과 같이 잠재적으로 다른 격리 요소들이다. 파드의 콘텍스트 내에서 개별 애플리케이션은 추가적으로 하위 격리가 적용된다. 도커 개념 측면에서, 파드는 공유 네임스페이스와 공유 파일시스템 볼륨이 있는 도커 컨테이너 그룹과 비슷하다.

# 파드가 여러 컨테이너를 관리하는 방법
파드는 응집력있는 서비스 단위를 형성하는 여러 협력 프로세스(컨테이너)를 지원하도록 설계되었다. 파드의 컨테이너는 클러스터의 동일한 물리 또는 가상 머신에서 자동으로 같은 위치에 배치되고 함께 스케줄된다. 컨테이너는 리소스와 의존성을 공유하고 서로 통신하고, 종료 시기와 방법을 조정할 수 있다. 

## 하나의 파드에 여러 컨테이너를 두는 경우에 대한 생각
- Web 3-Tier를 만드는 경우 web server, web app, DB를 하나의 파드로 묶어서 설계해도 되는가를 생각해보면 절대 그렇게 해서는 안된다. 이 기능들은 모두 주요한 기능들이다. SPoF를 기억하자. 
	- 실제로 애플리케이션들을 격리하는 이유는 SPoF를 막기 위해서이다. 자본이 많다면 애플리케이션 하나마다 하드웨어들로 격리하여 구성할 수 없다. 이것이 힘든경우 가상화를 이용한다. 하나의 하드웨어 위에 하이퍼바이저를 올리고 여러 대의 VM을 만들어 애플리케이션들을 격리한다. 
	- 하지만 게스트 운영체제를 사용한다는 것을 생각해봤을 때 용량이 적은 애플리케이션을 실행하기위해 그것보다 훨씬 더 무거운 운영체제를 사용해야한다는 단점이 있다. 또한 운영체제의 경우 시간이 오래 걸리는 부팅을 해야하기 때문에 스케일 아웃에 매우 불리하다.
	- 위에서와 마찬가지로 컨테이너를 사용하는 것도 결국은 애플리케이션을 격리하기 위해서 사용하는 것이다. 이렇게 해서 애플리케이션들이 서로 영향을 미치는 것을 막을 수 있다. 
- 가상화, 컨테이너를 사용하는 이유 중 하나가 격리를 하는 것인데 하나로 묶는 것 자체가 말이 안되는 짓이다. 

![](images/Pasted%20image%2020230214144138.png)
- 도커에서는 기본적으로 브릿지를 기반으로 컨테이너들이 하나의 IP 주소를 부여받게 된다. 그러나 쿠버네티스의 컨테이너들은 그렇지 않다. 하나의 파드안에 있는 컨테이너는 하나의 네트워크 스택을 공유하게 된다. 즉, 하나의 파드안에 있는 컨테이너들은 동일한 IP를 사용한다. 하나의 파드안에 있는 컨테이너들이 동일한 포트를 사용할 수 없다. 또한 파드안의 여러 개의 컨테이너들은 볼륨을 공유한다. 

