#CS #Network

# 네트워크 
- Local Area Network: 같은 IP 대역으로 통신
	- 네트워크 도메인: 같은 주소로 묶여있는 한 영역
	- 공유기가 LAN 환경을 만들어준다.

- 프로토콜: 컴퓨터 네트워크를 하기 위하여 송수신 장치 간 통일된 통신 규약
	- RFC(Request for Comments): 비평을 기다리는 문서라는 의미, 프로토콜에는 RFC 문서가 있다. 해당 프로토콜에 대해 정리가 되어 있는 공식 문서

## 계층 모델
- 처음에 네트워크가 있었을 때는 P2P였기 때문에 처음에는 규칙이 없었다. 이후 계층화 함. 계층화 되어있지 않고 통으로 되어있다면 중간에 맞지 않는 것만 커스터마이징 할 수 없다. 새로운 규약과 제품이 나오게 되면 해당 계층만 수정하면 된다. 그렇지 않다면 통째로 수정해야한다. 계층마다 각각의 기능에 대해서 분류를 하고 각각의 필요충분 조건을 체크하게 됨.

### OSI 7 Layer
- OSI 7 Layer의 에서 특히 알아야하고 정리해야할 내용
	1. 계층 별 특징
	2. 계층 별 PDU
	3. 계층 별 장비 및 Protocol

프로그램: 실행 파일, 프로세스: 메모리에 올라간 프로그램, 프로세서: 프로세스를 연산처리 하는 것

데이터 앞에 계속 무언가 붙여서 encapsultation한다.
- 응용계층
	- 브라우저, 응용프로그램
	- PDU: Data
	- Http
- 표현계층
	- 압축, 인코딩, 암호화, 코덱
	- SSL/TLS
- 세션계층
	- 포트를 프로세스에 연결해놓는다. 같은 포트로 유입되는 것은 다 똑같은 것으로 보이게 된다. 이를 구분하는 것이 세션이다. 
		- 특정 페이지에서 로그인을 하는 경우 특정 유저만을 위한 페이지가 아니기 때문에 특정 사용자를 구분지어야 한다. 로그인을 했을때 해당 정보를 가지고 있는 이유가 바로 이것이다. 이것을 식별하는 것이 세션이다. 
- 전송계층
	- PDU: Segment
	- tcp/udp
- 네트워크 계층
	- 관리의 목적으로 IP주소를 할당한다. MAC 주소와 IP를 매핑시켜준다. (ARP, 주소변환프로토콜)
		- 원래 하드웨어 정보는 MAC이지만 효과적으로 관리하기 위해서 IP주소를 사용하고 해당 대역을 사용한다고 명시하는 것이다. 
		- 2계층의 경우에는 IP주소를 알 수 없다. 스위치에 연결되어 있는 것 끼리 통신을 할때, 실제로 ping을 날린다면 IP로 통신을 하는 것이 아니라 해당 PC에서 MAC 주소를 받아오고 스위치에 있는 포트와 MAC 정보를 통해서 스위치에 해당 MAC과의 통신을 요청하는 것이다. 
			- ARP에서 브로드캐스팅은 마을에서 휴대전화를 이장이 하나가지고 있고 전화가 오는 경우 이장이 방송으로 전화가 왔다고 알려주는 방식을 생각해보면 된다. 
			- arp -a 로 arp 캐싱 테이블 확인 가능, arp -d로 캐싱 테이블 삭제가능, IP를 통해서 MAC주소를 받아오고 MAC 주소를 학습하게 되는 것을 확인할 수 있다. 브로드캐스트를 쓴다는 단점이 있다. 브로드 캐스트는 들을 수 있는 모든 주소에 통신을 보내는 것이다. 브로드 캐스트는 주소를 찾기 위해서 불필요한 통신을 많이 하게 되고 가용 대역폭(band width)중에서 실제 통신을 위한 대역폭이 줄어들게 되는 것이다. 이러한 경우 낭비를 줄이기 위해서 캐싱을 사용한다. arp cache table에 해당 정보가 있는 경우에는 브로드 캐스팅 하지 않게 된다.
	- 논리적인 주소를 사용, 경로 관리, 최적 경로 결정
	- PDU: Packet
	-  IP, icmp, igmp, ipsec
	- 라우터 사용
- 데이터 링크 계층
	- 데이터 전송을 위한 Format 결정, 데이터 전송을 위하여 Media에 접근하는 방법 제공, 물리적인 주소 사용, Error Detection 기능 제공
	- PDU: Frame
	- LLC(이더넷을 사용하느냐 다른 네트워크 망을 이용하느냐를 정의), MAC(랜카드 하드웨어 어드레스 고유 주소를 나타낸다.)
		- MAC 주소는 vendor의 고유 번호 + 생산 일련 번호, 랜카드 디바이스는 하드웨어 정보이다.(MAC OUI) 같은 네트워크 도메인을 가지는 곳에서 PC1 MAC과 PC2 MAC이 같은 경우 통신이 불가능하게 된다. MAC이 동일하면 어느 곳으로 정보를 보낼지 모르기 때문에 통신할 수 없다. 이러한 경우를 대비헤서 OS 레벨에서 MAC 주소를 변경할 수 있다. 
	- topology
		- 원래는 네트워크망을 어떻게 구성했는지 망에 대한 구조를 나타낸다.
		- 네트워크 망 끝에는 PC, 서버(엔드 포인트)가 붙어있을 것이다. 엔드 포인트 때문에 토폴로지가 생겨나게 됨
		- 기업에서 네트워크 망이 어떻게 구성되어있고 엔드 포인트에 무엇이 있는지 까지 나타나있기 때문에 대외비임
		- 보통 스타구조와 트리구조가 혼합된 형태
	- 스위치, 스위칭 허브
		- 네트워크 망을 만들기 위해서 사용한다. 전기적 신호를 각각의 엔드포인트로 찢어주는 역할을 한다.
- 물리 계층
	- 물리적인 연결. 전기적, 기계적, 기능적, 절차적인 수단 제공
		- 주파수를 재현하는 경우 해킹할 수 있다. 물리적 해킹
		- 실제 우리가 쓰는 네트워크는 해킹하기 어렵다. 그렇게 간단하지 않고 무엇이 0이고 무엇이 1인지 모르기 때문에 원래 정보를 알기 힘들다.
	- PDU: Bit
	- 케이블, 커넥터, 증폭기(리피터), hub
		- 허브는 전기적 신호를 모든 포트에 복제해서 한 번에 뿌린다. 

- 와이어샤크
	- 우리가 사용하고 있는 네트워크는 원래 모두 다 메모리에 올라간다. 메모리에 올라가서 담겨져 있는 공간을 back log(queueing) 공간이라고 한다. back log에 담겨졌다가 OS로 가게된다. 
	- protocol header는 반드시 protocol state diagram과 관련이 있다. 통신 정보는 헤더에 담기고 그것을 해결하기 위한 규칙을 state diagram이라고 하고 관련된 정보는 back log에 코딩되어 있다. 즉 back log를 통해 필터링 되어 거절되거나 OS로 넘거가거나 대기하거나 하는 등의 액션을 취하게 된다. https://nmap.org/book/tcpip-ref.html, https://www.cs.uni.edu/~diesburg/courses/cs3470_fa19/projects/p4-tcp.html, (TCP 의 경우이고 다른 프로토콜의 경우에는 다른 다이어그램을 가진다.)
	- 모두 메모리에서 처리하기 때문에 OS에서는 알지 못하고 OS로 넘어갈 수 있는 경우에만 넘어갈 수 있다.
	- 와이어샤크를 이용해서 back log queing 공간을 덤프를 떠서 그래프화 시켜주는 것이다. 
	- back log에 정책을 걸어주면 방화벽이 되고 보안 솔루션이 된다. 

