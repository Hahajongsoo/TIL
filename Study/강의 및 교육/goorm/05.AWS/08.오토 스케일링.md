# 가용성(Availability)
- 해당 시스템이나 서비스가 가동 및 실행되는 시간의 비율
- 가용성은 보통 9로 측정
	- three nine인 경우 99.9%의 가용성을 가지는 것을 의미하고 1년에 8.76시간(365 x 24 x 0.001) 동안 서비스가 중지됨을 의미한다.

# 확장성(Scalability)
- 서비스나 응용프로그램이 증가하는 성능 요구에 맞게 향상될 수 있는 정도
- 예를 들어 동시 접속자가 100명인 시스템에서 동시 접속자가 10~100배 늘어나는 경우 확장성이 높은 시스템은 사용자 증가에 따라 시스템 리소스를 손쉽게 추가/삭제할 수 있다.
- Scale up, Scale Out으로 해결

# Amazon Auto Scaling
- 트래픽에 따라서 인스턴스의 수를 자동으로 늘리거나 줄이는 기능을 한다.

| 구분      | 내용                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| --------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 서비스명  | Amazon Auto Scaling                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 설명      | 성능과 비용을 최적화하도록 애플리케이션 규모 조정                                                                                                                                                                                                                                                                                                                                                                                                  |
| 주요 특징 | - Auto Scaling을 사용하면 애플리케이션 가용성을 편하게 관리<br>- 사용자가 정의한 조건에 따라 EC2 용량이 자동으로 확장/축소<br>- 실행 중인 EC2 인스턴스의 수를 원하는 수준으로 유지 가능<br>- 수요가 급증할 경우 인스턴스의 수를 자동으로 증가(Scale Out)<br>- 수요가 적을 경우 자동으로 용량을 감소시켜 비용 낭비를 최소화(Scale in)<br>- 수요 변화가 많이 않은 애플리케이션과 사용량이 시, 일, 주 단위로 변하는 애플리케이션 모두에게 알맞은 상품 |
| 프리 티어 | Auto Scaling의 사용은 무료지만, AWS 리소스에 대한 비용과 CloudWatch 비용은 발생됨                                                                                                                                                                                                                                                                                                                                                                  | 

# Amazon Auto Scaling 의 구성요소
## Amazon Auto Scaling 그룹
- 인스턴스의 조정 및 관리 목적으로 구성된 논리적 그룹으로 Auto Scaling을 수행하는 인스턴스 모음
- 지정된 조건에 따라 인스턴스 수를 늘리거나, 비정상적으로 동작하는 경우 인스턴스 수를 유지하거나 비용 절감을 위해 인스턴스 수를 자동으로 조정

## 시작 구성
- Auto Scaling 그룹에서 인스턴스를 시작하는데 사용하는 템플릿
- AMI, 인스턴스 유형, 키 페어, 하나 이상의 보안 그룹, EBS 등 인스턴스에 대한 정보를 지정
- 시작 구성은 여러 개의 Auto Scaling 그룹에 지정될 수 있으나 Auto Scaling 그룹은 하나의 시작 구성만을 지정할 수 있다. 
- 한 번 생성한 이후에는 수정/변경 불가능

## 시작 템플릿
- 신버전의 시작 구성
- 템플릿의 내용을 수정할 수 있다. 

## Amazon Auto Scaling 그룹 조정
- 인스턴스의 수를 늘리거나 줄이는 기능
- 조정 작업은 이벤트와 함께 시작되거나, Auto Scaling 그룹의 인스턴스를 시작하거나 종료하도록 수행하는 조정 작업과 함께 수행된다.

### 인스턴스 조정 옵션
- 현재 인스턴스 수준 유지 관리: 최소 또는 항상 지정된 수의 인스턴스를 실행 유지 관리하도록 구성
- 수동 조정: Auto Scaling 그룹에서 최소, 최대 또는 원하는 용량의 변경 사항을 조정 변경 가능
- 일정을 기반으로 조정: 일정에 따른 확장 및 축소 작업을 날짜 함수를 통해 자동으로 수행되도록 구성
- 온디맨드 기반 조성: CPU, 메모리 사용량, 네트워크의 대역폭이 일정 수준 이상인 경우 새로운 인스턴스를 시작하고, 다시 내려가면 인스턴스를 종료하는 정책을 수립하여 적용

# 실습
- 시작 구성으로 시작
- 시작 템플릿으로 시작
- 클래식 로드 밸런서로 연결
- 애플리케이션 로드 밸런서로 연결

## 시작 구성
1. Auto Scaling -> 시작 구성
2. 시작 구성 만들기
	1. AMI의 경우 EC2 -> AMI -> AMI 카탈로그에서 id 확인
	2. 고급 세부 정보에서 실행할 셸 스크립트 작성
	3. IP 주소 유형 설정
3. Auto Scaling 그룹 생성
	1. 사용할 시작 구성 선택 
	2. VPC, 서브넷 선택
	3. 용량 선택, 크기 조정 정책 선택(원하는 경우)
4. 인스턴스 종료시 Auto Scaling 그룹에 맞게 새로 인스턴스가 생성되는 것을 확인할 수 있다.

## 시작 템플릿
1. EC2 > 인스턴스 > 시작 템플릿
2. 시작 템플릿 생성
	1. AMI 선택
	2. 인스턴스 유형 선택
	3. 키 페어
	4. 네트워크 설정
3. 시작 템플릿 수정
	1. 작업 > 템플릿 수정
	2. 고급 네트워크 구성
		1. 퍼블릭 IP 자동 할당 활성화
		2. 고급 세부 정보에 셸 스크립트 작성
3. 시작 템플릿 버전 세부 정보 확인 가능

## 클래식 로드 밸런서
1. EC2 > 로드 밸런서
2. 로드 밸런서 생성 > 클래식 로드 밸런서 생성
	1. VPC 선택
	2. 리스너 선택
	3. 서브넷 선택
	4. 보안 그룹 할당
	5. 인스턴스 추가 X
	6. 생성
3. Auto Scaling 그룹 > 생성
	1. 시작 템플릿 선택, 버전 선택
	2. VPC, 서브넷 선택
	3. 로드 밸런싱, 기존 로드 밸런서에 연결
		1. 클래식 로드밸런서에서 선택
4. 인스턴스 확인 및 로드밸런서 확인
	1. 로드밸런싱 되는 것 확인 가능

## 애플리케이션 로드 밸런서
1. 대상 그룹 생성
	1. 인스턴스 없으므로 타겟 포함하지 않고 생성
2. 애플리케이션 로드 밸런서 생성
3. Auto Scaling 그룹 생성
	1. 기존 로드밸런서에 연결
	2. 상태확인 유형 ELB로 선택
4. ELB로 하는 경우 인스턴스가 종료되지 않고 서비스만 종료하더라도 인스턴스의 변화가 생기게 된다.

![](images/Pasted%20image%2020230127163847.png)

![](images/Pasted%20image%2020230127163938.png)

![](images/Pasted%20image%2020230127163955.png)

기존 3개에서 4개로 늘어나게 된다. 그리고 health check에서도 결국 3개가 되는 것을 확인 가능

![](images/Pasted%20image%2020230127164115.png)
