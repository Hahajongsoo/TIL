
# Ansible
애플리케이션 및 IT 인프라를 자동화 할 수 있는 도구
- Ansible을 사용하여 호스트를 구성하고, 소프트웨어를 배포하고, 지속적인 배포 및 다운타임 없는 롤링 업데이트 등 고급 IT 작업을 조율할 수 있음
- Ansible의 주요 목적은 간결성과 사용 용이성이며 또한 보안과 신뢰성을 바탕으로 OpenSSH를 기본 전송 방법으로 사용
- 컨트롤 로드는 리눅스나 유닉스 시스템만 가능
- 관리 노드는 어떠한 시스템이든 상관없음
- 시스템 관리에 특별한 에이전트가 필요하지만 파이썬을 이용해서 해당 작업들을 행해야되기 때문에 컨트롤 로드든 관리 노드든 파이썬이 설치되어 있어야 함

## 장점
- SSH 기반이므로 원격 노드에 에이전트를 설치할  필요가 없음
- YAML 언어를 사용하기 때문에 쉽게 배울 수 있음
- 플레이북 구조는 간단하고 명확하게 구조화되어 있음'
- 변수 기능을 사용하여 같은 작업에 대해서 다른 구성으로 쉽게 구성할 수 있음
- 다른 도구보다 훨씬 간소화 된 코드 기반

## 단점
- 다른 프로그래밍 언어를 기반으로 하는 도구보다 덜 강력
- 변수 등록은 기본적인 기능조차도 요구되기 때문에 더 쉬운 작업을 더 복잡하게 만들 수 있음
- 플레이 내 변수의 값을 확인하기 어려울 수 있음
- 입력, 출력, 구성 파일의 형식간에 일관성이 없음
- 때때로 성능 속도가 저하됨

# Ansible 용어
### 컨트롤 노드
- Ansible이 설치된 모든 호스트
- 컨트롤 노드에서는 ansible 또는 ansible-playbook 명령을 이용하여 작업을 실행할 수 있음
- Python이 설치된 모든 호스트를 제어 노드로 사용할 수 있음 

### 관리 노드
- 컨트롤 머네신에 접근하여 모듈을 설치하고, 원격의 명령을 실행하는 작업을 수행하는 시스템. 쉽게 말해 컨트롤 머신에 의해 관리되는 시스템을 의미함


### 플러그인
- Ansible의 핵심 기능을 확장할 수 있도록 다양한 플러그인을 제공
- Action, Become, Cache, Callback, Cliconf, Connection, Httpapi, Inventory, Netconf, Lookup, Shell, Strategy, Vars

### 인벤토리
- 관리 노드의 목록으로, 관리 노드에 대한 호스트 이름이나 IP 주소와 같은 정보를 지정
- 여러 관리 노드를 그룹으로 조직화 할 수 있고 , 중첩 그룹을 사용할 수 있음

### 모듈
- Ansible을 실행하는 Python 코드 단위
- 각 모듈은 호스트에 패키지를 설치 및 관리하고, 데이터베이스의 사용자를 관리하고, 네트워크 장치의 VLAN 인터페이스를 관리할 수 있는 등 약 3000개의 모듈이 있음
- 하나의 모듈은 하나의 작업을 실행할 수 있고, 플레이북을 이용해 여러 모듈을 선언해 여러 작업을 수행할 수 있음 

### Task
- Ansible의 작업 실행 단위
- 하나의 모듈이 하나의 작업이 되며, Ad-hoc 명령을 통해 단일 작업을 실행하거나, 플레이북을 작성해 여러 작업을 실행할 수 있음

### Ad-hoc 명령
- Ansible 명령을 이용하여 단일 작업을 실행할 수 있음

### 플레이
- 특정 관리 노드를 대상으로한 순서가 지정된 작업 목록

### 플레이북
- 관리 노드에서 실행할 모듈을 인자와 함께 정의한 파일
- YAML로 작성되며, Ansible의 핵심
- ansible-playbook 명령을 이용해 플레이북을 실행할 수 있음

# Ansible 아키텍처
![](images/Pasted%20image%2020230130103459.png)

## 아키텍처 구성 내용
- 시스템 유형으로 컨트롤 머신과 관리 노드가 있음
- 컨트롤 노드에 Ansible이 설치되며, 관리 노드들은 컨트롤 머신에 의해 유지되거나 관리됨
- 관리 노드들은 인벤토리 파일에 나열되어야 하며, 여기에는 호스트이름 또는 IP 주소로 저장
- 인벤토리에 각 관리 노드들의 기능별로 그룹화 시켜서 저장도 가능
- 시스템 관리자는 컨트롤 노드에 로그인하여 플레이북 또는 원격 전송 명령을 사용하여  관리노드를 제어할 수 있고, 이 때 인벤토리에 저장된 관리 노드들을 패턴 형식으로 지정하여 제어할 수 있음
- 컨트롤 노드는 기본적으로 SSH를 사용하여 관리 노드와 통신
- 플레이북에서 참조한 모듈을 관리 노드에 복사되며, 관리 노드에서 실행
- 사용되는 모듈의 종류로는 코어 모듈과 사용자 지정 모듈 등이 있다. 